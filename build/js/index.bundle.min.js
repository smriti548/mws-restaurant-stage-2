var idbKeyval=function(e){"use strict";class t{constructor(e="keyval-store",t="keyval"){this.storeName=t,this._dbp=new Promise((n,r)=>{const a=indexedDB.open(e,1);a.onerror=(()=>r(a.error)),a.onsuccess=(()=>n(a.result)),a.onupgradeneeded=(()=>{a.result.createObjectStore(t)})})}_withIDBStore(e,t){return this._dbp.then(n=>new Promise((r,a)=>{const o=n.transaction(this.storeName,e);o.oncomplete=(()=>r()),o.onabort=o.onerror=(()=>a(o.error)),t(o.objectStore(this.storeName))}))}}let n;function r(){return n||(n=new t),n}return e.Store=t,e.get=function(e,t=r()){let n;return t._withIDBStore("readonly",t=>{n=t.get(e)}).then(()=>n.result)},e.set=function(e,t,n=r()){return n._withIDBStore("readwrite",n=>{n.put(t,e)})},e.del=function(e,t=r()){return t._withIDBStore("readwrite",t=>{t.delete(e)})},e.clear=function(e=r()){return e._withIDBStore("readwrite",e=>{e.clear()})},e.keys=function(e=r()){const t=[];return e._withIDBStore("readonly",e=>{(e.openKeyCursor||e.openCursor).call(e).onsuccess=function(){this.result&&(t.push(this.result.key),this.result.continue())}}).then(()=>t)},e}({});const DEBUG=!1;function urlForRestaurant(e){if(e)return`./restaurant.html?id=${e.id}`;console.error("Restaurant is null. Cannot build the URL to information page")}function imageUrlForRestaurant(e,t=800,n=!1){if(!e)return void console.error("Restaurant is null. Cannot build the image URL");if(n)return`./img/img-ph-${t}w.svg`;if(null===e.id)return`./img/missing-${t}w.svg`;return`./img/${e.id}-${t}w.jpg`}function cacheItems(e){e.forEach(e=>{cacheItem(e)})}function cacheItem(e){return idbKeyval.set(e.id,e)}function getCacheItem(e){return idbKeyval.get(e)}function isBrowserCompatiblewithServiceWorkers(){return!!navigator.serviceWorker||(console.warn("ServiceWorker is not compatible with this browser..."),!1)}function registerServiceWorker(){isBrowserCompatiblewithServiceWorkers()&&(DEBUG&&console.log("ServiceWorker is compatible with this browser!"),navigator.serviceWorker.register("sw.js").then(e=>{DEBUG&&console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){DEBUG&&console.log("ServiceWorker registration failed: ",e)}))}function checkServiceWorkerController(){if(!isBrowserCompatiblewithServiceWorkers())return;let e=document.querySelector("#jsServiceWorkerStatus"),t=document.createElement("span");navigator.serviceWorker.controller?t.className="c-sw-ok":t.className="c-sw-nok",e.appendChild(t)}function checkIfOffline(){this.fetch("./offline.html").catch(e=>{if("TypeError"===e.name){let e=document.querySelector(".map-offline-placeholder"),t=document.querySelector("#map"),n=document.querySelector("#static-map");null!=e&&null!=t&&(t.style.display="none",n.style.display="none",e.style.display="block")}})}window.addEventListener("load",()=>{registerServiceWorker(),checkServiceWorkerController();let e=document.querySelectorAll(".jsHomeLink");for(const t of e)t.href="./";checkIfOffline()}),function(e,t){var n=function(e,t){"use strict";if(t.getElementsByClassName){var n,r,a=t.documentElement,o=e.Date,i=e.HTMLPictureElement,s="addEventListener",l="getAttribute",c=e[s],d=e.setTimeout,u=e.requestAnimationFrame||d,h=e.requestIdleCallback,m=/^picture$/i,p=["load","error","lazyincluded","_lazyloaded"],f={},g=Array.prototype.forEach,y=function(e,t){return f[t]||(f[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),f[t].test(e[l]("class")||"")&&f[t]},v=function(e,t){y(e,t)||e.setAttribute("class",(e[l]("class")||"").trim()+" "+t)},M=function(e,t){var n;(n=y(e,t))&&e.setAttribute("class",(e[l]("class")||"").replace(n," "))},w=function(e,t,n){var r=n?s:"removeEventListener";n&&w(e,t),p.forEach(function(n){e[r](n,t)})},b=function(e,r,a,o,i){var s=t.createEvent("CustomEvent");return a||(a={}),a.instance=n,s.initCustomEvent(r,!o,!i,a),e.dispatchEvent(s),s},E=function(t,n){var a;!i&&(a=e.picturefill||r.pf)?a({reevaluate:!0,elements:[t]}):n&&n.src&&(t.src=n.src)},S=function(e,t){return(getComputedStyle(e,null)||{})[t]},k=function(e,t,n){for(n=n||e.offsetWidth;n<r.minSize&&t&&!e._lazysizesWidth;)n=t.offsetWidth,t=t.parentNode;return n},C=function(){var e,n,r=[],a=[],o=r,i=function(){var t=o;for(o=r.length?a:r,e=!0,n=!1;t.length;)t.shift()();e=!1},s=function(r,a){e&&!a?r.apply(this,arguments):(o.push(r),n||(n=!0,(t.hidden?d:u)(i)))};return s._lsFlush=i,s}(),A=function(e,t){return t?function(){C(e)}:function(){var t=this,n=arguments;C(function(){e.apply(t,n)})}},I=function(e){var t,n=0,a=r.throttleDelay,i=r.ricTimeout,s=function(){t=!1,n=o.now(),e()},l=h&&i>49?function(){h(s,{timeout:i}),i!==r.ricTimeout&&(i=r.ricTimeout)}:A(function(){d(s)},!0);return function(e){var r;(e=!0===e)&&(i=33),t||(t=!0,0>(r=a-(o.now()-n))&&(r=0),e||9>r?l():d(l,r))}},z=function(e){var t,n,r=function(){t=null,e()},a=function(){var e=o.now()-n;99>e?d(a,99-e):(h||r)(r)};return function(){n=o.now(),t||(t=d(a,99))}};!function(){var t,n={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};for(t in r=e.lazySizesConfig||e.lazysizesConfig||{},n)t in r||(r[t]=n[t]);e.lazySizesConfig=r,d(function(){r.init&&R()})}();var B=function(){var i,u,h,p,f,k,B,R,T,W,F,L,H,N,x=/^img$/i,D=/^iframe$/i,P="onscroll"in e&&!/glebot/.test(navigator.userAgent),$=0,U=0,q=-1,G=function(e){U--,e&&e.target&&w(e.target,G),(!e||0>U||!e.target)&&(U=0)},O=function(e,n){var r,o=e,i="hidden"==S(t.body,"visibility")||"hidden"!=S(e,"visibility");for(R-=n,F+=n,T-=n,W+=n;i&&(o=o.offsetParent)&&o!=t.body&&o!=a;)(i=(S(o,"opacity")||1)>0)&&"visible"!=S(o,"overflow")&&(r=o.getBoundingClientRect(),i=W>r.left&&T<r.right&&F>r.top-1&&R<r.bottom+1);return i},j=function(){var e,o,s,c,d,h,m,f,g,y=n.elements;if((p=r.loadMode)&&8>U&&(e=y.length)){o=0,q++,null==H&&("expand"in r||(r.expand=a.clientHeight>500&&a.clientWidth>500?500:370),L=r.expand,H=L*r.expFactor),H>$&&1>U&&q>2&&p>2&&!t.hidden?($=H,q=0):$=p>1&&q>1&&6>U?L:0;for(;e>o;o++)if(y[o]&&!y[o]._lazyRace)if(P)if((f=y[o][l]("data-expand"))&&(h=1*f)||(h=$),g!==h&&(k=innerWidth+h*N,B=innerHeight+h,m=-1*h,g=h),s=y[o].getBoundingClientRect(),(F=s.bottom)>=m&&(R=s.top)<=B&&(W=s.right)>=m*N&&(T=s.left)<=k&&(F||W||T||R)&&(r.loadHidden||"hidden"!=S(y[o],"visibility"))&&(u&&3>U&&!f&&(3>p||4>q)||O(y[o],h))){if(X(y[o]),d=!0,U>9)break}else!d&&u&&!c&&4>U&&4>q&&p>2&&(i[0]||r.preloadAfterLoad)&&(i[0]||!f&&(F||W||T||R||"auto"!=y[o][l](r.sizesAttr)))&&(c=i[0]||y[o]);else X(y[o]);c&&!d&&X(c)}},K=I(j),Y=function(e){v(e.target,r.loadedClass),M(e.target,r.loadingClass),w(e.target,J),b(e.target,"lazyloaded")},Z=A(Y),J=function(e){Z({target:e.target})},V=function(e){var t,n=e[l](r.srcsetAttr);(t=r.customMedia[e[l]("data-media")||e[l]("media")])&&e.setAttribute("media",t),n&&e.setAttribute("srcset",n)},Q=A(function(e,t,n,a,o){var i,s,c,u,p,f;(p=b(e,"lazybeforeunveil",t)).defaultPrevented||(a&&(n?v(e,r.autosizesClass):e.setAttribute("sizes",a)),s=e[l](r.srcsetAttr),i=e[l](r.srcAttr),o&&(c=e.parentNode,u=c&&m.test(c.nodeName||"")),f=t.firesLoad||"src"in e&&(s||i||u),p={target:e},f&&(w(e,G,!0),clearTimeout(h),h=d(G,2500),v(e,r.loadingClass),w(e,J,!0)),u&&g.call(c.getElementsByTagName("source"),V),s?e.setAttribute("srcset",s):i&&!u&&(D.test(e.nodeName)?function(e,t){try{e.contentWindow.location.replace(t)}catch(n){e.src=t}}(e,i):e.src=i),o&&(s||u)&&E(e,{src:i})),e._lazyRace&&delete e._lazyRace,M(e,r.lazyClass),C(function(){(!f||e.complete&&e.naturalWidth>1)&&(f?G(p):U--,Y(p))},!0)}),X=function(e){var t,n=x.test(e.nodeName),a=n&&(e[l](r.sizesAttr)||e[l]("sizes")),o="auto"==a;(!o&&u||!n||!e[l]("src")&&!e.srcset||e.complete||y(e,r.errorClass)||!y(e,r.lazyClass))&&(t=b(e,"lazyunveilread").detail,o&&_.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,U++,Q(e,t,o,a,n))},ee=function(){if(!u){if(o.now()-f<999)return void d(ee,999);var e=z(function(){r.loadMode=3,K()});u=!0,r.loadMode=3,K(),c("scroll",function(){3==r.loadMode&&(r.loadMode=2),e()},!0)}};return{_:function(){f=o.now(),n.elements=t.getElementsByClassName(r.lazyClass),i=t.getElementsByClassName(r.lazyClass+" "+r.preloadClass),N=r.hFac,c("scroll",K,!0),c("resize",K,!0),e.MutationObserver?new MutationObserver(K).observe(a,{childList:!0,subtree:!0,attributes:!0}):(a[s]("DOMNodeInserted",K,!0),a[s]("DOMAttrModified",K,!0),setInterval(K,999)),c("hashchange",K,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){t[s](e,K,!0)}),/d$|^c/.test(t.readyState)?ee():(c("load",ee),t[s]("DOMContentLoaded",K),d(ee,2e4)),n.elements.length?(j(),C._lsFlush()):K()},checkElems:K,unveil:X}}(),_=function(){var e,n=A(function(e,t,n,r){var a,o,i;if(e._lazysizesWidth=r,r+="px",e.setAttribute("sizes",r),m.test(t.nodeName||""))for(a=t.getElementsByTagName("source"),o=0,i=a.length;i>o;o++)a[o].setAttribute("sizes",r);n.detail.dataAttr||E(e,n.detail)}),a=function(e,t,r){var a,o=e.parentNode;o&&(r=k(e,o,r),(a=b(e,"lazybeforesizes",{width:r,dataAttr:!!t})).defaultPrevented||(r=a.detail.width)&&r!==e._lazysizesWidth&&n(e,o,a,r))},o=z(function(){var t,n=e.length;if(n)for(t=0;n>t;t++)a(e[t])});return{_:function(){e=t.getElementsByClassName(r.autosizesClass),c("resize",o)},checkElems:o,updateElem:a}}(),R=function(){R.i||(R.i=!0,_._(),B._())};return n={cfg:r,autoSizer:_,loader:B,init:R,uP:E,aC:v,rC:M,hC:y,fire:b,gW:k,rAF:C}}}(e,e.document);e.lazySizes=n,"object"==typeof module&&module.exports&&(module.exports=n)}(window);const CENTER_LATITUDE=40.722216,CENTER_LONGITUDE=-73.987501,STATIC_API_KEY="AIzaSyAmA6iiuvnfgbbtILevinrtaxR8AnwDhhU",DYNAMIC_API_KEY="AIzaSyAmA6iiuvnfgbbtILevinrtaxR8AnwDhhU";let mapContainer=document.querySelector(".map-container"),staticMapContainer=document.querySelector("#static-map");class StaticMapGenerator{constructor(){this.imageWidth=mapContainer.offsetWidth,this.imageHeight=window.innerHeight,this.imageScale=1,this.defaultZoom=10}static get staticApiBaseUrl(){return"https://maps.googleapis.com/maps/api/staticmap"}static get widthHeightRatioNarrow(){return.4}static get widthHeightRatioWide(){return 1.2}static get maxWidthForFreeApiPlan(){return 640}doesWindowWidthExceedFreePlan(){return window.innerWidth>StaticMapGenerator.maxWidthForFreeApiPlan}isWindowWidthUnderTabletBreakPoint(){return window.innerWidth<650}getImageHeightInPx(e,t=!0){const n=t?StaticMapGenerator.maxWidthForFreeApiPlan:window.innerWidth;return parseInt(n*(window.innerHeight*e)/window.innerWidth)}buildMarkers(e){let t="markers=color:red%7C",n=1;return e.forEach(r=>{n+=1,t+=`${r.latlng.lat},${r.latlng.lng}`,e.length>=n&&(t+="%7C")}),t}getApiUrl(e){this.doesWindowWidthExceedFreePlan()&&(this.imageHeight=this.getImageHeightInPx(StaticMapGenerator.widthHeightRatioNarrow),this.imageScale=2),this.isWindowWidthUnderTabletBreakPoint()&&(this.imageWidth=window.innerWidth,this.imageHeight=this.getImageHeightInPx(StaticMapGenerator.widthHeightRatioNarrow,!1),this.defaultZoom=11);const t=this.buildMarkers(e);return`${StaticMapGenerator.staticApiBaseUrl}?${t}&scale=${this.imageScale}&zoom=${this.defaultZoom}&size=${this.imageWidth}x${this.imageHeight}&key=${STATIC_API_KEY}`}getApiUrlForRestaurant(e){this.defaultZoom=16,this.doesWindowWidthExceedFreePlan()&&(this.imageHeight=this.getImageHeightInPx(StaticMapGenerator.widthHeightRatioWide),this.imageScale=2),this.isWindowWidthUnderTabletBreakPoint()&&(this.imageWidth=window.innerWidth,this.imageHeight=parseInt(this.imageWidth*StaticMapGenerator.widthHeightRatioNarrow));const t=this.buildMarkers([e]),n=`${StaticMapGenerator.staticApiBaseUrl}?${t}&scale=${this.imageScale}&zoom=${this.defaultZoom}&size=${this.imageWidth}x${this.imageHeight}&key=${STATIC_API_KEY}`;return console.log(n),n}}const dynamicMapContainer=document.getElementById("map");mapContainer.addEventListener("click",()=>{dynamicMapContainer.style.display="block",staticMapContainer.style.display="none"}),mapContainer.addEventListener("mouseover",()=>{dynamicMapContainer.style.display="block",staticMapContainer.style.display="none"});class MapsMarker{static mapMarkerForRestaurant(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}}function google_maps_init_on_index(){"use strict";let e={lat:CENTER_LATITUDE,lng:CENTER_LONGITUDE};self.map=new google.maps.Map(document.getElementById("map"),{zoom:11,center:e,scrollwheel:!1}),new IndexPage(self.map).updateMarkers()}function google_maps_init_on_restopage(){"use strict";(new RestaurantPage).addMarkerToMap().then(e=>{e&&(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:e.latlng,scrollwheel:!1}),MapsMarker.mapMarkerForRestaurant(e,self.map))}).catch(e=>{console.error(e)})}function google_maps_lazyload(e){"use strict";var t=document.location.pathname;if(e){var n=document.getElementById("map");new IntersectionObserver(function(r,a){if("boolean"==typeof r[0].isIntersecting?r[0].isIntersecting:r[0].intersectionRatio>0){loadJS(`https://maps.googleapis.com/maps/api/js?callback=${"/"===t||"/index.html"===t?"google_maps_init_on_index":"google_maps_init_on_restopage"}&libraries=places&key=${e}`),a.unobserve(n)}},{rootMargin:"100px",threshold:0}).observe(n)}}let focusedElementBeforeModal,openModalBtnTriggered;google_maps_lazyload(DYNAMIC_API_KEY);let openSearchModalBtn=document.querySelector(".open-search-modal"),openHoursModalBtn=document.querySelector(".open-hours-modal"),openReviewsModalBtn=document.querySelector(".open-reviews-modal");function openModal(){const e=findTargetModal(openModalBtnTriggered);focusedElementBeforeModal=document.activeElement,e.addEventListener("keydown",function(t){if(9===t.keyCode){if(function(e){if(e.shiftKey&&document.activeElement===n)return e.preventDefault(),r.focus(),!0;return!1}(t))return;document.activeElement==r&&(t.preventDefault(),n.focus())}27===t.keyCode&&closeModal(e)}),e.querySelector(".js-close-modal").addEventListener("click",function(){closeModal(e)});let t=e.querySelectorAll('a[href], area[href],\n  input:not([disabled]), select:not([disabled]),\n  textarea:not([disabled]), button:not([disabled]), iframe,\n  object, embed, [tabindex="0"], [contenteditable]');const n=(t=Array.prototype.slice.call(t))[0],r=t[t.length-1];e.style.display="block",n.focus()}function findTargetModal(e){const t=Array.prototype.slice.call(e.classList),n=t[t.length-1],r=document.querySelectorAll(".c-modal");for(const e of r){if(Array.prototype.slice.call(e.classList).includes(n))return e}throw"Modal wasn't found!"}function closeModal(e){e.style.display="none",focusedElementBeforeModal.focus()}null!=openSearchModalBtn&&openSearchModalBtn.addEventListener("click",function(){openModalBtnTriggered=openSearchModalBtn,openModal()}),null!=openHoursModalBtn&&openHoursModalBtn.addEventListener("click",function(){openModalBtnTriggered=openHoursModalBtn,openModal()}),null!=openReviewsModalBtn&&openReviewsModalBtn.addEventListener("click",function(){openModalBtnTriggered=openReviewsModalBtn,openModal()});const API_URL="http://localhost:1337/restaurants",STATIC_DATA_URL=`${location.origin}/data/restaurants.json`;function fetchRestaurants(){return idbKeyval.keys().then(e=>fetchFullData(e)).catch(e=>(console.error(e,null),!1))}function fetchFullData(e){var t=[];return e.forEach(e=>{t.push(getCacheItem(e).then(e=>e).catch(e=>{console.error("GetCacheItem failed",e)}))}),processPromises(t)}function processPromises(e){return DEBUG&&console.log(e),Promise.all(e).then(e=>e&&null!=e&&0!==e.length?(fetchApi2(),e):fetchApi2().then(e=>e).catch(e=>{console.error("Api call error",e)})).catch(e=>{console.error("allGetItemPromises error",e)})}function fetchApi2(){return fetch(API_URL).then(e=>{if(e.ok){return e.json()}DEBUG&&console.log("Fetch failed response",e)}).then(e=>(cacheItems(e),e)).catch(e=>{console.error("API is not available. Falling back to the static data...",e),fetchStaticDatabase()})}function fetchStaticDatabase(){fetch(STATIC_DATA_URL).then(e=>{if(!e.ok)return!1;return e.json()}).then(e=>{const t=Object.values(e.restaurants);return cacheItems(t),t}).catch(e=>(console.error("Some error appended",e),!1))}function fetchRestaurantFiltered(e){return fetchRestaurants().then(t=>{let n=t;return"all"!=e.cuisine&&(n=n.filter(t=>t.cuisine_type==e.cuisine)),"all"!=e.neighborhood&&(n=n.filter(t=>t.neighborhood==e.neighborhood)),n}).catch(e=>{console.error(e)})}function getFilters(){return fetchRestaurants().then(e=>{const t={},n=e.map((t,n)=>e[n].cuisine_type),r=e.map((t,n)=>e[n].neighborhood);return t.cuisines=n.filter((e,t)=>n.indexOf(e)==t),t.neighborhoods=r.filter((e,t)=>r.indexOf(e)==t),t}).catch(e=>{console.error(e)})}const applyFiltersBtn=document.querySelector(".js-apply-filters");function applyFilters(){(new IndexPage).updateRestaurants(),resetFocusToFiltersContainer()}function resetFocusToFiltersContainer(){document.getElementById("filters").focus()}applyFiltersBtn.addEventListener("click",applyFilters);class IndexPage{constructor(e){this.map=e,this.markers=[],this.restaurants=null}setRestaurants(e){return this.restaurants=e,this}hideLoadingScreen(){return document.querySelector(".loading-screen").style.display="none",this}fetchFilters(){return getFilters().then(e=>{e.neighborhoods&&this.fillFilterHtml(e.neighborhoods,"neighborhoods-select"),e.cuisines&&this.fillFilterHtml(e.cuisines,"cuisines-select")}).catch(e=>{console.error("fetchNeighborhoods",e)}),this}fillFilterHtml(e,t){const n=document.getElementById(t);e.forEach(e=>{if(void 0===e)return;const t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})}readFilters(){const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex;return{cuisine:e[n].value,neighborhood:t[r].value}}updateRestaurants(){const e=this.readFilters();return document.getElementById("filters-modal").style.display="none",fetchRestaurantFiltered(e).then(e=>{this.setRestaurants(e).resetRestaurants().fillRestaurantsHTML().hideLoadingScreen().createStaticMapImageElement().updateMap()}).catch(e=>{console.error(e)}),this}resetRestaurants(){return document.getElementById("restaurants-list").innerHTML="",this.resetMarkers(),this}resetMarkers(){this.markers.forEach(e=>e.setMap(null)),this.markers=[]}fillRestaurantsHTML(){const e=document.getElementById("restaurants-list");let t=document.querySelector(".no-restaurant-msg");return 0===this.restaurants.length?t.style.display="block":t.style.display="none",this.restaurants.forEach(t=>{e.append(this.createRestaurantHTML(t))}),document.getElementById("filters").focus(),this}createRestaurantHTML(e){const t=document.createElement("li");t.className="restaurant-container row-default";const n=document.createElement("div");n.className="restaurant-img-container";const r=document.createElement("img");r.className="lazyload restaurant-img",r.alt=`${e.name} restaurant, ${e.shortDesc}`,r.src=imageUrlForRestaurant(e,128,!0),r.setAttribute("data-src",imageUrlForRestaurant(e,128)),n.appendChild(r),t.append(n);const a=document.createElement("div");a.className="descriptions";const o=document.createElement("h2");o.innerHTML=e.name,a.append(o);const i=document.createElement("p");i.className="neighborhood",i.innerHTML=e.neighborhood,a.append(i);const s=document.createElement("p");s.className="address",s.innerHTML=e.address,a.append(s),t.append(a);const l=document.createElement("span");l.className="more-container";const c=document.createElement("a"),d=`Read ${e.name}'s restaurant details`;return c.className="c-btn btn-default btn-small btn-more",c.innerHTML="View details",c.setAttribute("aria-label",d),c.title=d,c.href=urlForRestaurant(e),l.appendChild(c),t.append(l),t}updateMarkers(){fetchRestaurantFiltered(this.readFilters()).then(e=>{this.setRestaurants(e).addMarkersToMap()})}addMarkersToMap(){this.resetMarkers(),this.restaurants.forEach(e=>{const t=MapsMarker.mapMarkerForRestaurant(e,this.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),this.markers.push(t)})}createStaticMapImageElement(){let e=document.querySelector("#static-map"),t=document.querySelector(".static-map-img");return null===t&&((t=document.createElement("img")).className="static-map-img"),t.alt="Static Google Maps of New-york. Hover or click to view the restaurants location.",t.src=new StaticMapGenerator("index").getApiUrl(this.restaurants),e.appendChild(t),this}updateMap(){const e=document.querySelector("#map");return null===e&&console.error(new Error("No element with the id 'map' found in the DOM.")),""===e.style.display?(this.createStaticMapImageElement(),this):(this.updateMarkers(),this)}}document.addEventListener("DOMContentLoaded",e=>{(new IndexPage).fetchFilters()});